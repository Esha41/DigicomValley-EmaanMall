@model EmaanMall.Models.ViewModel.OrderVM;



@{
    ViewData["Title"] = "Home Page";

}

<!DOCTYPE html>
<html lang="en">
<body>
    <!-- tap on top starts-->
    <!-- tap on tap ends-->
    <!-- page-wrapper Start-->
    <div class="page-wrapper compact-wrapper" id="pageWrapper">

        <!-- Page Body Start-->
        <div class="page-body-wrapper sidebar-icon">
            <!-- Page Sidebar Start-->
            <!-- Page Sidebar Ends-->
            <br /><br />

            <!-- Container-fluid starts-->
            <div class="container-fluid">
                <div class="row second-chart-list third-news-update">

                    <div class="col-xl-12 xl-100 chart_data_left box-col-12">
                        <div class="card">
                            <div class="card-body p-0">
                                <div class="row m-0 chart-main">
                                    <div class="col-xl-3 col-md-6 col-sm-6 p-0 box-col-6">
                                        <div class="media align-items-center">
                                            <div class="hospital-small-chart">

                                                <div class="small-bar">
                                                    <div class="small-chart flot-chart-container"></div>
                                                </div>
                                            </div>
                                            <div class="media-body">
                                                <div class="right-chart-content" style="cursor:pointer" onclick="window.open('@Url.Action("OrderHistory", "Orders", new { type = "all" })')">

                                                    <h4>@Model.orders.Count()</h4><span>Total Orders </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-3 col-md-6 col-sm-6 p-0 box-col-6">
                                        <div class="media align-items-center">
                                            <div class="hospital-small-chart">
                                                <div class="small-bar">
                                                    <div class="small-chart1 flot-chart-container"></div>
                                                </div>
                                            </div>
                                            <div class="media-body">
                                                <div class="right-chart-content" style="cursor:pointer" onclick="window.open('@Url.Action("OrderHistory", "Orders", new { type = "delivered" })')">
                                                    <h4>
                                                        @Model.orders.Where(s => s.OrderStatus.ToLower() == "delivered").Count()
                                                    </h4><span>Completed Orders</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-3 col-md-6 col-sm-6 p-0 box-col-6">
                                        <div class="media align-items-center">
                                            <div class="hospital-small-chart">
                                                <div class="small-bar">
                                                    <div class="small-chart2 flot-chart-container"></div>
                                                </div>
                                            </div>
                                            <div class="media-body">
                                                <div class="right-chart-content" style="cursor:pointer" onclick="window.open('@Url.Action("OrderHistory", "Orders", new { type = "rejected" })')">
                                                    <h4>@Model.orders.Where(s => s.OrderStatus.ToLower() == "rejected").Count()</h4><span>Rejected Orders</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-3 col-md-6 col-sm-6 p-0 box-col-6">
                                        <div class="media border-none align-items-center">
                                            <div class="hospital-small-chart">
                                                <div class="small-bar">
                                                    <div class="small-chart3 flot-chart-container"></div>
                                                </div>
                                            </div>
                                            <div class="media-body">
                                                <div class="right-chart-content" style="cursor:pointer"@* onclick="window.open('@Url.Action("OrderHistory", "Orders", new { type = "all" })')"*@>
                                                    <h6>
                                                        <small>Rs.</small>

                                                        @{
                                                            var sum1 = Model.orders.Where(s => s.OrderStatus.ToLower() == "delivered").Sum(s => s.OrderTotalPrice);
                                                            sum1 = Convert.ToDouble(String.Format("{0:0.00}", sum1));
                                                        }
                                                        @sum1
                                                    </h6><span>Total Revenue</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xl-3 col-lg-6">
                        <div class="card o-hidden" style="cursor:pointer" onclick="window.open('@Url.Action("Index", "Orders")')">
                            <div class="bg-primary b-r-4 card-body">
                                <div class="media static-top-widget">
                                    <div class="align-self-center text-center"><i data-feather="database"></i></div>
                                    <div class="media-body">
                                        <p class="m-0">Pending Orders</p>
                                        <h4 class="mb-0 counter">@Model.Allorders.Where(s => s.OrderStatus.ToLower() == "processing").Count()</h4><i class="icon-bg" data-feather="database"></i>
                                        <br />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                  @*  <div class="col-sm-6 col-xl-3 col-lg-6">
                        <div class="card o-hidden" style="cursor:pointer" onclick="window.open('@Url.Action("Index", "Orders")')">
                            <div class="bg-secondary b-r-4 card-body">
                                <div class="media static-top-widget">
                                    <div class="align-self-center text-center"><i data-feather="shopping-bag"></i></div>
                                    <div class="media-body">
                                        <p class="m-0">Pending Orders Revenue</p>
                                        <h6 class="mb-0 counter">
                                            @{
                                                var sum = Model.Allorders.Where(s => s.OrderStatus.ToLower() == "processing").Sum(s => s.OrderTotalPrice);
                                                sum = Convert.ToDouble(String.Format("{0:0.00}", sum));
                                            }
                                            @sum
                                        </h6><i class="icon-bg" data-feather="shopping-bag"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>*@
                    <div class="col-sm-6 col-xl-3 col-lg-6">
                        <div class="card o-hidden" style="cursor:pointer" onclick="window.open('@Url.Action("Index", "ProductInquiries")')">
                            <div class="bg-secondary b-r-4 card-body">
                                <div class="media static-top-widget">
                                    <div class="align-self-center text-center"><i data-feather="message-circle"></i></div>
                                    <div class="media-body">
                                        <p class="m-0">Pending Inquiries</p>
                                        <h4 class="mb-0 counter">
                                            @{
                                              @*  var sum = Model.Allorders.Where(s => s.OrderStatus.ToLower() == "processing").Sum(s => s.OrderTotalPrice);
                                                sum = Convert.ToDouble(String.Format("{0:0.00}", sum));*@
                                            var sum = Model.productInquiries.Count();
                                            }
                                            @sum
                                        </h4><i class="icon-bg" data-feather="message-circle"></i>
                                        <br />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xl-3 col-lg-6">
                        <div class="card o-hidden" style="cursor:pointer" onclick="window.open('@Url.Action("Index", "ProductDetail")')">
                            <div class="bg-primary b-r-4 card-body">
                                <div class="media static-top-widget">
                                    <div class="align-self-center text-center"><i data-feather="user-plus"></i></div>
                                    <div class="media-body">
                                        <p class="m-0">All Products</p>
                                        <h4 class="mb-0 counter">@Model.productDetails.Count()</h4><i class="icon-bg" data-feather="user-plus"></i>
                                        <br />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    @if (!User.IsInRole("Vendor"))
                    {
                    <div class="col-sm-6 col-xl-3 col-lg-6">
                        <div class="card o-hidden" style="cursor:pointer" onclick="window.open('@Url.Action("Index", "PromoCode")')">
                            <div class="bg-secondary b-r-4 card-body">
                                <div class="media static-top-widget">
                                    <div class="align-self-center text-center"><i data-feather="message-circle"></i></div>
                                    <div class="media-body">
                                        <p class="m-0">Promo Codes</p>
                                        <h4 class="mb-0 counter">@Model.promocodeList.Count()</h4><i class="icon-bg" data-feather="message-circle"></i>
                                        <br />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="best-seller-table responsive-tbl">
                                    <div class="item">
                                        <div class="table-responsive product-list">
                                            <div class="row">
                                                <div class="col-6">
                                                    <h4>Pending Order Inquiries</h4>
                                                </div>
                                                <div class="col-6" style="text-align:right">
                                                    <button class="btn btn-sm btn-primary glow" style="background-color: #2B7A78;color:white" onclick="window.open('@Url.Action("Index", "ProductInquiries")')"> View All</button>

                                                </div>
                                            </div>
                                            <br />
                                            <table class="table table-bordernone" id="basic-2" style="border:none">
                                                <thead>

                                                    <tr>
                                                        <th>#</th>
                                                        <th class="text-center">
                                                            Customer Name
                                                        </th>
                                                        <th class="text-center">
                                                            Product Name
                                                        </th>
                                                        <th class="text-center">
                                                            Date
                                                        </th>
                                                        <th class="text-center">
                                                            Status
                                                        </th>
                                                        <th class="text-center">
                                                            Inquiry Status
                                                        </th>
                                                        <th class="text-center">
                                                            Action
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @{ var count = 0;}
                                                    @foreach (var item in Model.productInquiries)
                                                    {
                                                        <tr>
                                                            <td class="text-center">@{ count = count + 1; } @count</td>
                                                            <td class="text-center">
                                                                @Html.DisplayFor(modelItem => item.customer.FirstName)
                                                            </td>
                                                            <td class="text-center">
                                                                @Html.DisplayFor(modelItem => item.productDetail.Product.ProductName)
                                                            </td>
                                                            <td class="text-center">
                                                                @Convert.ToString(string.Format("{0:d/M/yyyy}", item.ProductInquiryDate))
                                                            </td>
                                                            @if (item.Status == true)
                                                            {
                                                                <td class="text-success py-1 text-center">Active</td>
                                                            }
                                                            else
                                                            {
                                                                <td class="text-danger py-1 text-center">Deactive</td>
                                                            }
                                                            <td class="text-center">
                                                                @if (item.ProductInquiryStatus == "pending")
                                                                {
                                                                    <select id="select1" onchange="ChangeInquiryStatus(this,@item.ProductInquiryId)" style="height:30px; border-radius:10px;">
                                                                        <option value="pending" selected>Pending</option>
                                                                        <option value="processing">Processing</option>
                                                                        <option value="approved">Approved</option>
                                                                        <option value="unapproved">unApproved</option>
                                                                    </select>
                                                                }
                                                                else if (item.ProductInquiryStatus == "processing")
                                                                {

                                                                    <select id="select1" onchange="ChangeInquiryStatus(this,@item.ProductInquiryId)" style="height:30px; border-radius:10px;">
                                                                        <option value="pending">Pending</option>
                                                                        <option value="processing" selected>Processing</option>
                                                                        <option value="approved">Approved</option>
                                                                        <option value="unapproved">unApproved</option>
                                                                    </select>
                                                                }
                                                                else if (item.ProductInquiryStatus == "approved")
                                                                {

                                                                    <select id="select1" onchange="ChangeInquiryStatus(this,@item.ProductInquiryId)" style="height:30px; border-radius:10px;">
                                                                        <option value="pending">Pending</option>
                                                                        <option value="processing">Processing</option>
                                                                        <option value="approved" selected>Approved</option>
                                                                        <option value="unapproved">unApproved</option>
                                                                    </select>
                                                                }
                                                                else if (item.ProductInquiryStatus == "unapproved")
                                                                {

                                                                    <select id="select1" onchange="ChangeInquiryStatus(this,@item.ProductInquiryId)" style="height:30px; border-radius:10px;">
                                                                        <option value="pending">Pending</option>
                                                                        <option value="processing">Processing</option>
                                                                        <option value="approved">Approved</option>
                                                                        <option value="unapproved" selected>unApproved</option>
                                                                    </select>
                                                                }
                                                            </td>
                                                            <td class="text-center">

                                                                <a class="mb-2 mr-2 btn-icon btn-icon-only btn-shadow btn-dashed btn btn-outline-warning" asp-controller="ProductInquiries" asp-action="Details" asp-route-id="@item.ProductInquiryId" target="_blank"><i class="icon-comment-alt"></i></a>

                                                            </td>
                                                        </tr>
                                                                }

                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                                                                }
                    <div class="col-xl-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="best-seller-table responsive-tbl">
                                    <div class="item">
                                        <div class="table-responsive product-list">
                                            <div class="row">
                                                <div class="col-6">
                                                    <h4> New Orders</h4>
                                                </div>
                                                <div class="col-6" style="text-align:right">
                                                    <button class="btn btn-sm btn-primary glow" style="background-color: #2B7A78;color:white" onclick="window.open('@Url.Action("Index", "Orders")')"> View All</button>

                                                </div>
                                            </div>
                                            <br />
                                            <table class="table table-bordernone" id="basic-1" style="border:none">
                                                <thead>

                                                    <tr>
                                                        <th>
                                                            Customer Name
                                                        </th>
                                                        <th>Phone No</th>
                                                        <th>OrderNo</th>
                                                        <th>Order Date</th>

                                                        <th>Sub Total</th>
                                                        <th>Order Status</th>
                                                        <th>Details</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @foreach (var item in Model.Allorders.Where(s => s.OrderStatus.ToLower() == "processing"))
                                                    {
                                                        <tr>
                                                            <td>
                                                                <div class="d-inline-block align-middle">
                                                                    <img class="img-40 m-r-15 rounded-circle align-top" src="~/assets/images/avtar/7.jpg" alt="">
                                                                    <div class="status-circle bg-primary"></div>
                                                                    <div class="d-inline-block">
                                                                        <span>@Html.DisplayFor(modelItem => item.OrderRecipentName)</span>
                                                                        <p class="font-roboto">@Html.DisplayFor(modelItem => item.OrderShippingAddress)</p>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td>@Html.DisplayFor(modelItem => item.OrderRecipentPhone)</td>

                                                            <td>@Html.DisplayFor(modelItem => item.OrderNo)</td>
                                                            <td>   @Convert.ToString(string.Format("{0:d/M/yyyy}", item.OrderDate))</td>

                                                            <td> <span class="label">@Html.DisplayFor(modelItem => item.OrderTotalPrice)</span></td>
                                                            <td>@Html.DisplayFor(modelItem => item.OrderStatus)</td>
                                                            <td>
                                                                <a class="mb-2 mr-2 btn-icon btn-icon-only btn-shadow btn-dashed btn btn-outline-primary" asp-controller="Orders" asp-action="Details" asp-route-id="@item.OrderId" target="_blank"><i class="icon-comment-alt"></i></a>
                                                            </td>
                                                        </tr>
                                                    }

                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="col-xl-6 xl-50 box-col-12">
                        <div class="card">
                            <div class="card-header card-no-border">
                                <h5>New Products</h5>

                                <div class="card-header-right">
                                    <div class="btn-actions-pane-right actions-icon-btn">
                                        <button class="btn btn-sm btn-primary glow" style="background-color: #2B7A78;color:white" onclick="window.open('@Url.Action("Index", "ProductDetail")')"> View All</button>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body pt-0">
                                <div class="our-product">
                                    <div class="table-responsive">

                                        <table class="table table-bordernone" id="basic-1">
                                            <tbody class="f-w-500">
                                                @foreach (var item in Model.products)
                                                {
                                                    <tr>
                                                        <td>
                                                            <div class="media">
                                                                <div class="media-body">
                                                                    <span>@Html.DisplayFor(modelItem => item.Product.ProductName)</span>
                                                                    <p class="font-roboto"></p>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <button type="button" class="mb-2 mr-2 btn btn-light btn-icon-right" style="background-color: #e0ebeb" onclick="window.open('@Url.Action("Index", "ProductDetail" ,new {Prodid= @item.ProductId })')">
                                                                @Model.productDetails.Where(a => a.ProductId == item.ProductId).Count() Products
                                                            </button>


                                                        </td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="col-xl-6 xl-50 box-col-12">
                        <div class="card">
                            <div class="card-header card-no-border">
                                <h5>Offered Categories</h5>
                                <div class="card-header-right">
                                    <div class="btn-actions-pane-right actions-icon-btn">
                                        <button class="btn btn-sm btn-primary glow" style="background-color: #2B7A78;color:white" onclick="window.open('@Url.Action("Index", "Categories")')"> View All</button>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body pt-0">

                                <div class="our-product">
                                    <div class="table-responsive">

                                        <table class="table table-bordernone" id="basic-1">
                                            <tbody class="f-w-500">
                                                @foreach (var item in Model.productCategories)
                                                {
                                                    if (item != null)
                                                    {
                                                        <tr>
                                                            <td>
                                                                <div class="media">
                                                                    <div class="media-body">
                                                                        <span>@Html.DisplayFor(modelItem => item.Category.CategoryName)</span>
                                                                        <p class="font-roboto"></p>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <button type="button" class="mb-2 mr-2 btn btn-light btn-icon-right" style="background-color: #e0ebeb" onclick="window.open('@Url.Action("Index", "ProductDetail", new { Catid = @item.CategoryId })')">
                                                                    @Model.AllproductCategories.Where(a => a.CategoryId == item.CategoryId).Count() Products
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    }
                                                }
                                            </tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>















                    <div class="greeting-user text-center" hidden>

                        <h4 class="f-w-600"><span id="greeting"></span> <span class="right-circle"><i class="fa fa-check-circle f-14 middle"></i></span></h4>


                        <div class="left-icon"></div>
                    </div>

                </div>
            </div>
            <!-- Container-fluid Ends-->
            <!-- footer start-->

        </div>
    </div>

    <!-- latest jquery-->
    <!-- Bootstrap js-->
    <script src="~/assets/js/bootstrap/popper.min.js"></script>
    <script src="~/assets/js/bootstrap/bootstrap.js"></script>
    <!-- feather icon js-->
    <script src="~/assets/js/icons/feather-icon/feather.min.js"></script>
    <script src="~/assets/js/icons/feather-icon/feather-icon.js"></script>
    <!-- Sidebar jquery-->
    <script src="~/assets/js/config.js"></script>
    <!-- Plugins JS start-->
    <script src="~/assets/js/sidebar-menu.js"></script>
    <script src="~/assets/js/chart/chartist/chartist.js"></script>
    <script src="~/assets/js/chart/chartist/chartist-plugin-tooltip.js"></script>
    <script src="~/assets/js/chart/knob/knob.min.js"></script>
    <script src="~/assets/js/chart/knob/knob-chart.js"></script>
    <script src="~/assets/js/chart/apex-chart/apex-chart.js"></script>
    <script src="~/assets/js/chart/apex-chart/stock-prices.js"></script>
    <script src="~/assets/js/notify/bootstrap-notify.min.js"></script>
    <script src="~/assets/js/dashboard/default.js"></script>
    <script src="~/assets/js/notify/index.js"></script>
    <script src="~/assets/js/datepicker/date-picker/datepicker.js"></script>
    <script src="~/assets/js/datepicker/date-picker/datepicker.en.js"></script>
    <script src="~/assets/js/datepicker/date-picker/datepicker.custom.js"></script>
    <script src="~/assets/js/typeahead/handlebars.js"></script>
    <script src="~/assets/js/typeahead/typeahead.bundle.js"></script>
    <script src="~/assets/js/typeahead/typeahead.custom.js"></script>
    <script src="~/assets/js/typeahead-search/handlebars.js"></script>
    <script src="~/assets/js/typeahead-search/typeahead-custom.js"></script>
    <script src="~/assets/js/scrollable/perfect-scrollbar.min.js"></script>
    <script src="~/assets/js/scrollable/scrollable-custom.js"></script>
    <script src="~/assets/js/tooltip-init.js"></script>
    <!-- Plugins JS Ends-->
    <!-- Theme js-->

    <script src="~/assets/js/theme-customizer/customizer.js"></script>
    <!-- login js-->
    <!-- Plugin used-->







    <script src="~/assets/js/prism/prism.min.js"></script>
    <script src="~/assets/js/clipboard/clipboard.min.js"></script>
    <script src="~/assets/js/counter/jquery.waypoints.min.js"></script>
    <script src="~/assets/js/counter/jquery.counterup.min.js"></script>
    <script src="~/assets/js/counter/counter-custom.js"></script>
    <script src="~/assets/js/custom-card/custom-card.js"></script>
    <script src="~/assets/js/owlcarousel/owl.carousel.js"></script>
    <script src="~/assets/js/dashboard/dashboard_2.js"></script>


</body>
</html>
@section Scripts
{
    <script>
        function ChangeInquiryStatus(val, id) {
            var Status = val.value;
            $.ajax({
                type: "Post",
                url: '/ProductInquiries/ChangeInquiryStatus',
                data: {
                    id: id,
                    Status: Status
                },
                success: function (json) {
                    if (json == "Success") {

                        window.location.reload();
                    }

                },
                error: function (xhr) {

                }
            });
        }

    </script>
}